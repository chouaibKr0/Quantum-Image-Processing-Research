% chapters/algorithms/quantum-ffqoak.tex
% FFQOAK: Fast Forward Quantum Optimization Algorithm with K-means

\subsection{FFQOAK: Hybrid Quantum-Inspired K-means Clustering}
\label{sec:ffqoak}

The Fast Forward Quantum Optimization Algorithm combined with K-means (FFQOAK)~\cite{singh2021ffqoak} represents a hybrid quantum-classical approach that addresses fundamental limitations of standard K-means clustering~\cite{macqueen1967kmeans,xu2015clustering}: sensitivity to initialization and convergence to local optima. By incorporating quantum-inspired optimization~\cite{jasso2023qknn}, FFQOAK achieves more robust global optimization for image segmentation tasks.

\begin{keyconceptbox}[FFQOAK Core Innovation]
FFQOAK integrates quantum-inspired optimization principles with classical K-means through a two-phase framework:
\begin{itemize}
    \item \textbf{Phase 1 (Quantum Optimization):} FFQOA searches for optimal cluster centers using quantum-inspired dynamics
    \item \textbf{Phase 2 (Classical Clustering):} K-means performs pixel assignment based on optimized centers
\end{itemize}
This synergy combines global search capability with efficient local refinement.
\end{keyconceptbox}

\subsubsection{Background: K-means Limitations}

Standard K-means clustering minimizes within-cluster variance:
\begin{equation}
    J = \sum_{i=1}^{n} \sum_{z=1}^{\theta} \|P_i - C_z\|^2
\end{equation}
where $P_i$ represents pixel intensity values, $C_z$ are cluster centroids, $\theta$ is the number of clusters, and $n$ is the total number of pixels.

The algorithm alternates between:
\begin{enumerate}
    \item \textbf{Assignment:} $\text{Label}_i = \arg\min_z \|P_i - C_z\|^2$
    \item \textbf{Update:} $C_z = \frac{1}{|S_z|} \sum_{i \in S_z} P_i$
\end{enumerate}

\begin{warningbox}[K-means Limitations]
Critical issues affecting segmentation quality:
\begin{itemize}
    \item \textbf{Initialization sensitivity:} Different starting centers produce vastly different results
    \item \textbf{Local optima:} Algorithm terminates at suboptimal solutions
    \item \textbf{Fixed cluster count:} Requires prior knowledge of $\theta$
\end{itemize}
These limitations are particularly problematic in medical imaging where accurate delineation is crucial~\cite{jun2020covid}.
\end{warningbox}

\subsubsection{The FFQOA Framework}

The Fast Forward Quantum Optimization Algorithm draws inspiration from quantum mechanical principles to achieve superior optimization performance.

\paragraph{Quantum Mechanical Inspiration}

FFQOA models optimization as a quantum system where:
\begin{itemize}
    \item Each potential solution is represented as a \textbf{quantum} ($Q_k$)
    \item The solution space forms a quantum potential landscape
    \item Quantum properties (location, movement, displacement) guide search dynamics
\end{itemize}

\paragraph{Quantum System Initialization}

The quantum system is initialized using a Schr√∂dinger equation-inspired formulation:
\begin{equation}
    Q_k(e) = \phi \cdot Q1_k(e) + (1-\phi) \cdot Q2_k(e)
\end{equation}
where:
\begin{itemize}
    \item $Q_k(e)$ represents the $k$-th quantum at epoch $e$
    \item $\phi = \frac{1}{\sqrt{2}}(1 + i)$ is a complex superposition coefficient
    \item $Q1_k(e) = C_{min} + r_1 \cdot (C_{max} - C_{min})$
    \item $Q2_k(e) = C_{min} + r_2 \cdot (C_{max} - C_{min})$
    \item $r_1, r_2 \in [0,1]$ are random numbers
\end{itemize}

The complex coefficient $\phi$ introduces quantum superposition principles, allowing each quantum to explore multiple search regions simultaneously.

\paragraph{Quantum Properties}

\begin{definitionbox}[FFQOA Quantum Properties]
\textbf{Location} ($L_k(e)$): Quantum position in search space
\begin{equation}
    L_k(e) = \frac{1}{Q_k(e)} e^{-2/Q_k(e)}
\end{equation}

\textbf{Movement} ($M_k(e)$): Tendency to change position
\begin{equation}
    M_k(e) = \left|Q_k(e) - \frac{L_k(e)}{2} \ln(1/m_f)\right|
\end{equation}
where $m_f \in [0,1]$ is the quantum movement factor.

\textbf{Displacement} ($D_k(e)$): Actual position change
\begin{equation}
    D_k(e) = 2 \cdot |L_k(e) - M_k(e)|
\end{equation}
\end{definitionbox}

\paragraph{Three-Component Search Enhancement}

The key innovation of FFQOA is its three-component movement update mechanism:
\begin{equation}
    M_k(e+1) = M_1 + M_2 + M_3
\end{equation}

\begin{enumerate}
    \item \textbf{Preceding Movement Component} ($M_1$):
    \begin{equation}
        M_1 = w \cdot M_k(e)
    \end{equation}
    where $w$ is an inertia weight maintaining search momentum (exploitation).
    
    \item \textbf{Local Search Component} ($M_2$):
    \begin{equation}
        M_2 = c_1 \cdot r_3 \cdot (pBD_k(e) - D_k(e))
    \end{equation}
    where $pBD_k(e)$ is the personal best displacement (local learning).
    
    \item \textbf{Global Search Component} ($M_3$):
    \begin{equation}
        M_3 = c_2 \cdot r_4 \cdot (gBD(e) - D_k(e))
    \end{equation}
    where $gBD(e)$ is the global best displacement (collective knowledge).
\end{enumerate}

The displacement update follows:
\begin{equation}
    D_k(e+1) = D_k(e) + M_k(e+1)
\end{equation}

\begin{tipbox}[Exploration-Exploitation Balance]
The three components create a balanced search strategy:
\begin{itemize}
    \item $M_1$ maintains momentum (exploitation of current trajectory)
    \item $M_2$ incorporates individual experience (local refinement)
    \item $M_3$ leverages collective information (global exploration)
\end{itemize}
\end{tipbox}

\subsubsection{FFQOAK Integration}

\paragraph{Mathematical Integration}

Cluster centers are represented as quantum displacements:
\begin{itemize}
    \item Each set of potential centers forms a quantum displacement $D_j(e)$
    \item K-means objective evaluates fitness: $\hat{J}_j(e) = J(D_j(e))$
    \item FFQOA optimizes $D_j(e)$ to minimize $\hat{J}_j(e)$
\end{itemize}

\begin{algorithm}[H]
\caption{FFQOAK Algorithm}
\begin{algorithmic}[1]
\Require Image $I_p$ with gray levels $G_{ld} = \{P_1, P_2, \ldots, P_n\}$
\Require Number of clusters $\theta$, quantum population $N_Q$, max epochs $E$
\Ensure Optimal cluster centers, segmented image $I_s$
\State \textbf{// Initialization}
\State Initialize $N_Q$ quanta with random cluster centers
\State Compute initial fitness $\hat{J}_j(0)$ for each quantum
\State Set $pBD_j(0) = D_j(0)$ and identify $gBD(0)$
\For{$e = 1$ to $E$}
    \For{each quantum $j = 1$ to $N_Q$}
        \State \textbf{// Update quantum properties}
        \State Update location $L_j(e)$
        \State Compute three-component movement $M_j(e)$
        \State Update displacement $D_j(e) = D_j(e-1) + M_j(e)$
        \State \textbf{// K-means evaluation}
        \State Decode $D_j(e)$ to cluster centers $C_1, \ldots, C_\theta$
        \State Assign pixels to nearest centers
        \State Compute fitness $\hat{J}_j(e)$
        \State \textbf{// Update best solutions}
        \If{$\hat{J}_j(e) < \hat{J}(pBD_j)$}
            \State $pBD_j(e) = D_j(e)$
        \EndIf
    \EndFor
    \State Update global best $gBD(e)$ if improved
\EndFor
\State Extract optimal centers from $gBD(E)$
\State Generate segmented image $I_s$
\State \Return Cluster centers, $I_s$
\end{algorithmic}
\end{algorithm}

\subsubsection{Parameter Configuration}

\begin{notebox}[Recommended Parameters]
Based on empirical studies for medical image segmentation:
\begin{itemize}
    \item Number of clusters: $\theta = 3$ (for COVID-19 CT segmentation)
    \item Quantum population: $N_Q = 30$
    \item Inertia weight: $w = 0.7$
    \item Learning coefficients: $c_1 = c_2 = 1.5$
    \item Maximum epochs: $E = 100$
    \item Movement factor: $m_f = 0.5$
\end{itemize}
\end{notebox}

\subsubsection{Advantages Over Classical Methods}

\paragraph{Escaping Local Optima}

The quantum tunneling effect, modeled through complex number formulation and stochastic components, enables FFQOAK to escape poor local minima that trap standard K-means.

\paragraph{Initialization Independence}

Unlike classical K-means:
\begin{itemize}
    \item Multiple quanta explore different initial configurations simultaneously
    \item Global best tracking ensures convergence to high-quality solutions
    \item Reduced sensitivity to random initialization
\end{itemize}

\paragraph{Computational Advantages}

\begin{itemize}
    \item \textbf{Parallel exploration:} Quantum system inherently explores multiple solutions
    \item \textbf{Adaptive search:} Balance between exploration and exploitation evolves
    \item \textbf{Information sharing:} Global best component enables rapid propagation of good solutions
\end{itemize}


\subsubsection{Complexity Analysis}

\textbf{Time Complexity:}
\begin{itemize}
    \item Per epoch: $O(N_Q \cdot n \cdot \theta)$ for fitness evaluation
    \item Total: $O(E \cdot N_Q \cdot n \cdot \theta)$
\end{itemize}

\textbf{Space Complexity:} $O(N_Q \cdot \theta + n)$ for storing quanta and pixel data

Compared to standard K-means $O(I \cdot n \cdot \theta)$ where $I$ is iteration count, FFQOAK introduces overhead from quantum population but achieves better solution quality with fewer restarts.
